var TJDashboardUI={initDashboard:function(e){TJDashboardService.getDashboard(e).done(function(e){if(!e.data.dashboard_id)return!1;if(jQuery('<h1><div data-dashboard-id="'+e.data.dashboard_id+'" class="tjdashboard-title">'+e.data.title+"</div></h1>").appendTo(".tjdashboard"),e.data.widget_data.length<=0)return jQuery('<div class="alert alert-info"> No widgets found to show</div>').appendTo(".tjdashboard"),!1;var a=0,d=0,r=1;return jQuery('<div class="row dashboard-widget-row-'+r+'">').appendTo(".tjdashboard"),jQuery.each(e.data.widget_data,function(t,i){var n="panel-default";0!=i.color.length&&(n="panel-"+i.color),jQuery('<div class="col-xs-'+i.size+'"><div class="widget-data panel '+n+'"><div class="widget-title panel-heading"><b>'+i.title+'</b></div><div data-dashboard-widget-id="'+i.dashboard_widget_id+'" id="dashboard-widget-'+i.dashboard_widget_id+'" class=""></div></div></div>').appendTo(".dashboard-widget-row-"+r),TJDashboardUI.initWidget(i.dashboard_widget_id),d++,12===(a=parseInt(a)+parseInt(i.size))&&e.data.widget_data.length!==d&&(r++,jQuery('</div><div class="row dashboard-widget-row-'+r+'">').appendTo(".tjdashboard"),a=0),e.data.widget_data.length===d&&jQuery("</div>").appendTo(".tjdashboard")}),!0})},initWidget:function(e){TJDashboardService.getWidget(e).done(function(e){if(!e.data.dashboard_widget_id)return alert("no data"),!1;if(!TJDashboardUI._validWidget(e.data.widget_render_data)||0==e.data.widget_render_data.data.length)return jQuery('<div class="alert alert-info">No data to render</div>').appendTo("#dashboard-widget-"+e.data.dashboard_widget_id),!1;jQuery(window).trigger("resize");var a=[];a.element="dashboard-widget-"+e.data.dashboard_widget_id,a.data=e.data.widget_render_data;var d=e.data.renderer_plugin.split("."),r=d[0],t=d[1];if(!a&&!e.data.renderer_plugin)return!1;var i="TJDashboard"+TJDashboardUI._jsUcFirst(r);return TJDashboardUI._addCssFiles(e.data.widget_css),TJDashboardUI._addJsFiles(e.data.widget_js,t,a,i),!0})},_addCssFiles:function(e){jQuery.each(e,function(e,a){var d=document.createElement("link");d.href=a,d.type="text/css",d.rel="stylesheet",0==jQuery.find("link [href='"+a+"']").length&&jQuery("head").append(d)})},_addJsFiles:function(e,a,d,r){jQuery.each(e,function(e,t){jQuery.getScript(t,function(){window[r].renderData(a,d)})})},_validWidget:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},_jsUcFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},_setRenderers:function(){var e=jQuery("#jform_data_plugin").val(),a=jQuery("#jform_renderer_plugin").val(),d=TJDashboardService.getRenderers(e);jQuery("#jform_renderer_plugin").replaceWith('<select id="jform_renderer_plugin" name="jform[renderer_plugin]" class="required" required="required" aria-required="true"><option value="">Select renderer plugin</option></select>'),jQuery("#jform_renderer_plugin").find("option").not(":first").remove(),d.done(function(e){var d=jQuery("#jform_renderer_plugin");jQuery.each(e.data,function(e,a){d.append(new Option(a,e))}),jQuery("#jform_renderer_plugin").val(a)})},_setSize:function(){var e=jQuery("#jform_size").val();jQuery("#jform_size").replaceWith('<select id="jform_size" name="jform[size]" class="inputbox required" required="required" aria-required="true"><option value="">Select Size</option><option value="12">COM_TJDASHBOARD_WIDGET_FORM_FULL_WIDTH</option><option value="6">COM_TJDASHBOARD_WIDGET_FORM_HALF_WIDTH</option><option value="4">COM_TJDASHBOARD_WIDGET_FORM_ONE_THIRD_WIDTH</option><option value="3">COM_TJDASHBOARD_WIDGET_FORM_ONE_FOURTH_WIDTH</option></select>'),jQuery("#jform_size").val(e)}};